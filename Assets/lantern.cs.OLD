using UnityEngine;

public class Lantern : MonoBehaviour
{
    [Header("Thành phần của Đèn")]
    public GameObject lightSource; // Kéo Point Light vào đây
    public GameObject fireModel;   // Kéo ngọn lửa giả (Sphere) vào đây
    
    [Header("Trạng thái")]
    public bool isLit = false; // Đèn đã sáng chưa?

    void Start()
    {
        // Tắt đèn lúc bắt đầu game
        if(lightSource) lightSource.SetActive(false);
        if(fireModel) fireModel.SetActive(false);
    }

    // Hàm bật đèn (được gọi khi Player bấm E)
    public void LightUp()
    {
        if (isLit) return; // Nếu sáng rồi thì thôi

        isLit = true;
        if(lightSource) lightSource.SetActive(true);
        if(fireModel) fireModel.SetActive(true);
        
        Debug.Log("Đèn đã được thắp sáng!");
    }

    // Khi Ma đi vào vùng sáng
    void OnTriggerEnter(Collider other)
    {
        if (!isLit) return; // Đèn chưa sáng thì ma không sợ

        // Tìm xem có phải là Ma (PaperEnemy) không
        PaperEnemy enemy = other.GetComponent<PaperEnemy>();
        if (enemy != null)
        {
            enemy.EnterLightZone(); // Làm chậm ma
        }
    }

    // Khi Ma đi ra khỏi vùng sáng
    void OnTriggerExit(Collider other)
    {
        PaperEnemy enemy = other.GetComponent<PaperEnemy>();
        if (enemy != null)
        {
            enemy.ExitLightZone(); // Ma chạy nhanh lại
        }
    }
}
